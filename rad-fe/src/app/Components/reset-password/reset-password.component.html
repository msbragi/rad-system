<div *transloco="let t; read: 'resetPassword'" class="reset-password-container">
  <div class="reset-password-card">
    <h1 class="reset-password-title">{{ t("resetYourPassword") }}</h1>

    @if (tokenInvalid) {
      <div class="token-invalid">
        <p>{{ t("tokenInvalid") }}</p>
        <button
          mat-raised-button
          color="primary"
          [routerLink]="['/forgot-password']"
        >
          {{ t("requestNewLink") }}
        </button>
      </div>
    }

    @if (!tokenInvalid) {
      <form [formGroup]="resetForm" (ngSubmit)="submit()">
        <p class="reset-password-instruction">{{ t("enterNewPassword") }}</p>
        <!-- Password field -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>{{ t("newPassword") }}</mat-label>
          <input
            matInput
            formControlName="password"
            [type]="hidePassword ? 'password' : 'text'"
            [placeholder]="t('passwordPlaceholder')"
          />
          <button
            mat-icon-button
            matSuffix
            type="button"
            (click)="hidePassword = !hidePassword"
            [attr.aria-label]="'Toggle password visibility'"
          >
            <mat-icon>{{
              hidePassword ? "visibility_off" : "visibility"
            }}</mat-icon>
          </button>
          @if (resetForm.get("password")?.hasError("required")) {
            <mat-error>
              {{ t("passwordRequired") }}
            </mat-error>
          }
          @if (resetForm.get("password")?.hasError("minlength")) {
            <mat-error>
              {{ t("passwordMinLength") }}
            </mat-error>
          }
        </mat-form-field>
        <!-- Confirm Password field -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>{{ t("confirmPassword") }}</mat-label>
          <input
            matInput
            formControlName="confirmPassword"
            [type]="hideConfirmPassword ? 'password' : 'text'"
            [placeholder]="t('confirmPasswordPlaceholder')"
          />
          <button
            mat-icon-button
            matSuffix
            type="button"
            (click)="hideConfirmPassword = !hideConfirmPassword"
            [attr.aria-label]="'Toggle password visibility'"
          >
            <mat-icon>{{
              hideConfirmPassword ? "visibility_off" : "visibility"
            }}</mat-icon>
          </button>
          @if (resetForm.get("confirmPassword")?.hasError("required")) {
            <mat-error>
              {{ t("confirmPasswordRequired") }}
            </mat-error>
          }
          @if (resetForm.hasError("mismatch")) {
            <mat-error>
              {{ t("passwordsDoNotMatch") }}
            </mat-error>
          }
        </mat-form-field>
        <button
          mat-raised-button
          color="primary"
          type="submit"
          [disabled]="resetForm.invalid || loading"
          class="full-width"
        >
          {{ loading ? t("resetting") : t("resetPassword") }}
        </button>
      </form>
    }

    <div class="back-to-login">
      <a [routerLink]="['/login']">{{ t("backToLogin") }}</a>
    </div>
  </div>
</div>
