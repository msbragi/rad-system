<div
  *transloco="let t; read: 'forgotPassword'"
  class="forgot-password-container"
>
  <div class="forgot-password-card">
    <h1 class="forgot-password-title">
      {{ isLoggedIn ? t("changePassword") : t("resetPassword") }}
    </h1>

    @if (isLoggedIn && ssoLinks.length > 0) {
      <div class="sso-links">
        <p>{{ t("ssoChangePasswordInfo") }}</p>
        <ul>
          @for (link of ssoLinks; track link.provider) {
            <li>
              <a [href]="link.url" target="_blank" rel="noopener">
                {{ t("changeOnProvider", { provider: link.provider }) }}
              </a>
            </li>
          }
        </ul>
        <div class="actions">
          <button
            mat-stroked-button
            type="button"
            [routerLink]="['/dashboard']"
          >
            {{ t("cancel") }}
          </button>
        </div>
      </div>
    } @else {
      <p class="forgot-password-subtitle">
        {{ isLoggedIn ? t("changePasswordInfo") : t("enterEmail") }}
      </p>
      <form [formGroup]="forgotPasswordForm" (ngSubmit)="submit()">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>{{ t("emailLabel") }}</mat-label>
          <input
            matInput
            formControlName="email"
            type="email"
            [placeholder]="t('emailPlaceholder')"
            [readonly]="isLoggedIn"
          />
          @if (forgotPasswordForm.get("email")?.hasError("required")) {
            <mat-error>
              {{ t("emailRequired") }}
            </mat-error>
          }
          @if (forgotPasswordForm.get("email")?.hasError("email")) {
            <mat-error>
              {{ t("emailInvalid") }}
            </mat-error>
          }
        </mat-form-field>
        <div class="actions">
          <button
            mat-stroked-button
            type="button"
            [routerLink]="isLoggedIn ? ['/dashboard'] : ['/login']"
          >
            {{ t("cancel") }}
          </button>
          <button
            mat-raised-button
            color="primary"
            type="submit"
            [disabled]="forgotPasswordForm.invalid || loading"
          >
            {{
              loading
                ? t("sending")
                : isLoggedIn
                  ? t("sendChangeLink")
                  : t("sendResetLink")
            }}
          </button>
        </div>
      </form>
    }
  </div>
</div>
